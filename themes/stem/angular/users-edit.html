<h1 class="page-header" ng-if="!add">Edit Account '{{ user.account }}'</h1>
<h1 class="page-header" ng-if="add">Add a New User</h1>

<section>
<div class="coontiNgFormElement row" ng-if="add">
  <div class="col-sm-2">
    <label for="userAccount" class="formElementRequired">Account</label>
  </div>
  <div class="col-sm-10">
	<input type="text" id="userAccount" name="userAccount" ng-model="user.account" required/>
	<p class="inputNote small">Account cannot be changed later.</p>
  </div>
</div>
</section>

<section>
<h4>Allowed Rights</h4>
<table class="table table-striped table-condensed table-responsive">
  <tbody>
	<tr ng-repeat="item in user.allowed|orderBy">
	  <td>{{ rights[item].displayName }}</td>
	  <td>{{ rights[item].description }}</td>
	  <td><a ng-click="removeAllowedRight(user, item)" href="">Remove</a></td>
	</tr>
	<tr ng-if="user.allowed.length == 0">
	  <td>No allowed rights.</td>
	</tr>
	<tr ng-if="availableRights.length > 0">
	  <td colspan="3" class="inlineFormContainer">
		<select ng-model="$parent.selectedAllowedRight" ng-options="i.name as i.displayName for i in availableRights">
		</select>
		<button ng-click="addAllowedRight(user)">Allow Right</button>
	  </td>
	</tr>
	<tr ng-if="availableRights.length == 0">
	  <td colspan="3">No rights available.</td>
	</tr>
  </tbody>
</table>
</section>

<section>
<h4>Denied Rights</h4>
<table class="table table-striped table-condensed table-responsive">
  <tbody>
	<tr ng-repeat="item in user.denied|orderBy">
	  <td>{{ rights[item].displayName }}</td>
	  <td>{{ rights[item].description }}</td>
	  <td><a ng-click="removeDeniedRight(user, item)" href="">Remove</a></td>
	</tr>
	<tr ng-if="user.denied.length == 0">
	  <td>No denied rights.</td>
	</tr>
	<tr ng-if="availableRights.length > 0">
	  <td colspan="3" class="inlineFormContainer">
		<select ng-model="$parent.selectedDeniedRight" ng-options="i.name as i.displayName for i in availableRights">
		</select>
		<button ng-click="addDeniedRight(user)">Deny Right</button>
	  </td>
	</tr>
	<tr ng-if="availableRights.length == 0">
	  <td colspan="3">No rights available.</td>
	</tr>
  </tbody>
</table>
</section>

<section>
<h4>Groups</h4>
<table class="table table-striped table-condensed table-responsive">
  <tbody>
	<tr ng-repeat="item in user.groups|orderBy">
	  <td>{{ groups[item].name }}</td>
	  <td>{{ groups[item].description }}</td>
	  <td><a ng-click="removeGroup(user, item)" href="">Remove</a></td>
	</tr>
	<tr ng-if="user.groups.length == 0">
	  <td>No groups.</td>
	</tr>
	<tr ng-if="availableGroups.length > 0">
	  <td colspan="3" class="inlineFormContainer">
		<select ng-model="$parent.selectedGroup" ng-options="i._id as i.name for i in availableGroups">
		</select>
		<button ng-click="addGroup(user)">Add</button>
	  </td>
	</tr>
	<tr ng-if="availableGroups.length == 0">
	  <td colspan="3">No groups available.</td>
	</tr>
  </tbody>
</table>
</section>

<section>
<h4>Roles</h4>
<table class="table table-striped table-condensed table-responsive">
  <tbody>
	<tr ng-repeat="item in user.roles|orderBy">
	  <td>{{ roles[item].name }}</td>
	  <td>{{ roles[item].description }}</td>
	  <td><a ng-click="removeRole(user, item)" href="">Remove</a></td>
	</tr>
	<tr ng-if="user.roles.length == 0">
	  <td>No roles.</td>
	</tr>
	<tr ng-if="availableRoles.length > 0">
	  <td colspan="3" class="inlineFormContainer">
		<select ng-model="$parent.selectedRole" ng-options="i._id as i.name for i in availableRoles">
		</select>
		<button ng-click="addRole(user)">Add</button>
	  </td>
	</tr>
	<tr ng-if="availableRoles.length == 0">
	  <td colspan="3">No roles available.</td>
	</tr>
  </tbody>
</table>
</section>

<section>
<p><button ng-if="add" ng-click="create(user)">Add</button><button ng-if="!add" ng-click="save(user)">Save</button> <button back>Cancel</button></p>
</section>